print(sil)
plot(2:20, sil)
myKmean <- function(X, k){
res <- kmeans(X,k, iter.max = 50)
list("cluster" = res$cluster, "predict" = function(Z){
closest.point <- function(x) {
cluster.dist <- apply(res$centers, 1, function(y) sqrt(sum((x-y)^2)))
return(which.min(cluster.dist)[1])}
return(apply(Z, 1, closest.point))
}, "centroids" = res$centers)
}
sil <- array(0,19)
for (k in 2:20){
print(k)
#cn <- consensusCLustering_Boot(X,k,clustering = myKmean, C=100)
cn <- myKmean(X,k)$cluster
sil[k-1]<- index.KL(X, cn)
}
print(sil)
plot(2:20, sil)
sil <- array(0,19)
for (k in 2:20){
print(k)
#cn <- consensusCLustering_Boot(X,k,clustering = myKmean, C=100)
cn <- myKmean(X,k)$cluster
sil[k-1]<- index.KL(X, cn)$KL
}
print(sil)
plot(2:20, sil)
library(fpc)
prediction.strength
library(class)
library(mclust)
library(rgl)
library(car)
library(caret)
library(anocva)
library(apcluster)
library(MixAll)
library(fpc)
library(clusterSim)
library(clValid)
library(RSKC)
library(fossil)
library(dendextend)
library(spatstat)
mu1 <- c(-10,10)
mu2 <- c(10,10)
mu3 <- c(10,-10)
mu4 <- c(-10,-10)
sig1 <- genPositiveDefMat(2)$Sigma
sig2 <- genPositiveDefMat(2)$Sigma
sig3 <- genPositiveDefMat(2)$Sigma
sig4 <- genPositiveDefMat(2)$Sigma
c1 <- mvrnorm(n = 50, mu = mu1, Sigma = 3*diag(2))
c2 <- mvrnorm(n = 50, mu = mu2, Sigma = 3*diag(2))
c3 <- mvrnorm(n = 50, mu = mu3, Sigma = 3*diag(2))
c4 <- mvrnorm(n = 50, mu = mu4, Sigma = 3*diag(2))
X <- rbind(c1,c2,c3,c4)
plot(c1[,1],c1[,2], col="black", xlim = c(-25,25), ylim = c(-25,25))
points(c2[,1],c2[,2], col="blue")
points(c3[,1],c3[,2], col="red")
points(c4[,1], c4[,2], col="green")
apply(X,2, mean)
cov(X)
X -apply(X, 2, mean)
X
t(t(X) -apply(X, 2, mean))
X[1,]
t(t(X) -apply(X, 2, mean))
X[1,]
t(t(X) -apply(X, 2, mean))[1,]
t(t(X) -apply(X, 2, mean))[1,] - X[1,]
c <- t(t(X) -apply(X, 2, mean))
m <- t(t(X) -apply(X, 2, mean))
c <- cov(X)
t(m)%*%c%*%m
m%*%c%*%m
m%*%c%*%t(m)
t <- m%*%c%*%t(m)
diag(t)
X <- rbind(c(1,0),c(2,1),c(-1,1))
X
m <- t(t(X) -apply(X, 2, mean))
m
c <- cov(X)
t <- m%*%c%*%t(m)
diag(t)
cov(X)
1/6
13*9/3
13/9/3
inv(X)
install.packages("matlib")
library(matlib)
DeD <- function(X, seq){
n <- nrow(X)
Di <- mdist(X)
DM <- max(Di)
delta <- mean(Di-DM)
DW <- seq
for (k in seq) {
range <- n/k
start <-0
end <- 0
deltak <- 0
for (j in 1:k){
start <- end +1
end <- start + range -1
Dik <- mdist(X[start:end,])
DMk <- max(Dik)
deltak <- deltak + mean(Dik - DMk)
}
DW <- deltak/k
}
DeD <- 2*DW - delta
return(list(DeD=DeD, k=which.max(DeD)))
}
mdist <- function(X){
mx <- apply(X, 2,mean)
d <- t(X)-mx
Di <- 1/(1 + diag(t(d)%*%inv(cov(X))%*%d))
return(Di)
}
DeD(X, 2:10)
X
dim(X)
mu1 <- c(-10,10)
mu2 <- c(10,10)
mu3 <- c(10,-10)
mu4 <- c(-10,-10)
sig1 <- genPositiveDefMat(2)$Sigma
sig2 <- genPositiveDefMat(2)$Sigma
sig3 <- genPositiveDefMat(2)$Sigma
sig4 <- genPositiveDefMat(2)$Sigma
c1 <- mvrnorm(n = 50, mu = mu1, Sigma = 3*diag(2))
c2 <- mvrnorm(n = 50, mu = mu2, Sigma = 3*diag(2))
c3 <- mvrnorm(n = 50, mu = mu3, Sigma = 3*diag(2))
c4 <- mvrnorm(n = 50, mu = mu4, Sigma = 3*diag(2))
X <- rbind(c1,c2,c3,c4)
plot(c1[,1],c1[,2], col="black", xlim = c(-25,25), ylim = c(-25,25))
points(c2[,1],c2[,2], col="blue")
points(c3[,1],c3[,2], col="red")
points(c4[,1], c4[,2], col="green")
DeD(X, 2:10)
DeD <- function(X, seq){
n <- nrow(X)
Di <- mdist(X)
DM <- max(Di)
delta <- mean(Di-DM)
DW <- seq
for (k in seq) {
range <- n/k
start <-0
end <- 0
deltak <- 0
for (j in 1:k){
start <- end +1
end <- start + range -1
Dik <- mdist(X[start:end,])
DMk <- max(Dik)
deltak <- deltak + mean(Dik - DMk)
}
DW[k] <- deltak/k
}
DeD <- 2*DW - delta
return(list(DeD=DeD, k=which.max(DeD)))
}
mdist <- function(X){
mx <- apply(X, 2,mean)
d <- t(X)-mx
Di <- 1/(1 + diag(t(d)%*%inv(cov(X))%*%d))
return(Di)
}
DeD(X, 2:10)
data("iris")
iris
X <- iris[1:4,]
DeD(X, 2:10)
X
X <- iris[,1:4]
DeD(X, 2:10)
DeD <- function(X, seq){
n <- nrow(X)
Di <- mdist(X)
DM <- max(Di)
delta <- mean(Di-DM)
DW <- seq
for (k in seq) {
range <- n/k
start <-0
end <- 0
print(deltak)
deltak <- 0
for (j in 1:k){
start <- end +1
end <- start + range -1
Dik <- mdist(X[start:end,])
DMk <- max(Dik)
deltak <- deltak + mean(Dik - DMk)
}
DW[k] <- deltak/k
}
DeD <- 2*DW - delta
return(list(DeD=DeD, k=which.max(DeD)))
}
DeD(X, 2:10)
DeD <- function(X, seq){
n <- nrow(X)
Di <- mdist(X)
DM <- max(Di)
delta <- mean(Di-DM)
DW <- seq
for (k in seq) {
range <- n/k
start <-0
end <- 0
deltak <- 0
for (j in 1:k){
start <- end +1
end <- start + range -1
Dik <- mdist(X[start:end,])
DMk <- max(Dik)
deltak <- deltak + mean(Dik - DMk)
}
print(deltak)
DW[k] <- deltak/k
}
DeD <- 2*DW - delta
return(list(DeD=DeD, k=which.max(DeD)))
}
DeD(X, 2:10)
DeD <- function(X, seq){
n <- nrow(X)
Di <- mdist(X)
DM <- max(Di)
delta <- mean(Di-DM)
DW <- numeric(length(seq))
for (k in seq) {
range <- n/k
start <-0
end <- 0
deltak <- 0
for (j in 1:k){
start <- end +1
end <- start + range -1
Dik <- mdist(X[start:end,])
DMk <- max(Dik)
deltak <- deltak + mean(Dik - DMk)
}
print(deltak)
DW[k] <- deltak/k
}
DeD <- 2*DW - delta
return(list(DeD=DeD, k=which.max(DeD)))
}
DeD(X, 2:10)
which(c(0,2,5,4), 4)
DeD <- function(X, seq){
n <- nrow(X)
Di <- mdist(X)
DM <- max(Di)
delta <- mean(Di-DM)
DW <- numeric(length(seq))
i=1
for (k in seq) {
range <- n/k
start <-0
end <- 0
deltak <- 0
for (j in 1:k){
start <- end +1
end <- start + range -1
Dik <- mdist(X[start:end,])
DMk <- max(Dik)
deltak <- deltak + mean(Dik - DMk)
}
print(deltak)
DW[i] <- deltak/k
i <- i+1
}
DeD <- 2*DW - delta
return(list(DeD=DeD, k=which.max(DeD)))
}
DeD(X, 2:10)
DeD <- function(X, seq){
n <- nrow(X)
Di <- mdist(X)
DM <- max(Di)
delta <- mean(Di-DM)
DW <- numeric(seq)
i=1
for (k in seq) {
range <- n/k
start <-0
end <- 0
deltak <- 0
for (j in 1:k){
start <- end +1
end <- start + range -1
Dik <- mdist(X[start:end,])
DMk <- max(Dik)
deltak <- deltak + mean(Dik - DMk)
}
print(deltak)
DW[i] <- deltak/k
i <- i+1
}
DeD <- 2*DW - delta
return(list(DeD=DeD, k=which.max(DeD)))
}
DeD(X, 2:10)
DeD <- function(X, seq){
n <- nrow(X)
Di <- mdist(X)
DM <- max(Di)
delta <- mean(Di-DM)
DW <- numeric(seq)
i=1
for (k in seq) {
range <- n/k
start <-0
end <- 0
deltak <- 0
for (j in 1:k){
start <- end +1
end <- start + range -1
Dik <- mdist(X[start:end,])
DMk <- max(Dik)
deltak <- deltak + mean(Dik - DMk)
}
print(deltak)
DW[i] <- deltak/k
i <- i+1
}
DeD <- 2*DW - delta
return(list(DeD=DeD, k=which.max(DeD)))
}
DeD(X, 2:10)
DeD <- function(X, seq){
n <- nrow(X)
Di <- mdist(X)
DM <- max(Di)
delta <- mean(Di-DM)
DW <- seq
i=1
for (k in seq) {
range <- n/k
start <-0
end <- 0
deltak <- 0
for (j in 1:k){
start <- end +1
end <- start + range -1
Dik <- mdist(X[start:end,])
DMk <- max(Dik)
deltak <- deltak + mean(Dik - DMk)
}
print(deltak)
DW[i] <- deltak/k
i <- i+1
}
DeD <- 2*DW - delta
return(list(DeD=DeD, k=which.max(DeD)))
}
DeD(X, 2:10)
mu1 <- c(-10,10)
mu2 <- c(10,10)
mu3 <- c(10,-10)
mu4 <- c(-10,-10)
sig1 <- genPositiveDefMat(2)$Sigma
sig2 <- genPositiveDefMat(2)$Sigma
sig3 <- genPositiveDefMat(2)$Sigma
sig4 <- genPositiveDefMat(2)$Sigma
c1 <- mvrnorm(n = 50, mu = mu1, Sigma = 3*diag(2))
c2 <- mvrnorm(n = 50, mu = mu2, Sigma = 3*diag(2))
c3 <- mvrnorm(n = 50, mu = mu3, Sigma = 3*diag(2))
c4 <- mvrnorm(n = 50, mu = mu4, Sigma = 3*diag(2))
X <- rbind(c1,c2,c3,c4)
plot(c1[,1],c1[,2], col="black", xlim = c(-25,25), ylim = c(-25,25))
points(c2[,1],c2[,2], col="blue")
points(c3[,1],c3[,2], col="red")
points(c4[,1], c4[,2], col="green")
DeD(X, 2:10)
DeD <- function(X, seq){
n <- nrow(X)
Di <- mdist(X)
DM <- max(Di)
delta <- mean(Di-DM)
DW <- seq
i=1
for (k in seq) {
range <- n/k
start <-0
end <- 0
deltak <- 0
for (j in 1:k){
start <- end +1
end <- start + range -1
Dik <- mdist(X[start:end,])
DMk <- max(Dik)
deltak <- deltak + mean(Dik - DMk)
}
print(deltak)
DW[i] <- deltak/k
i <- i+1
}
DeD <- 2*DW - delta
return(list(DeD=DeD, k=which.min(DeD)))
}
DeD(X, 2:10)
DeD <- function(X, seq){
n <- nrow(X)
Di <- mdist(X)
DM <- max(Di)
delta <- mean(Di-DM)
DW <- seq
i=1
for (k in seq) {
range <- n/k
start <-0
end <- 0
deltak <- 0
for (j in 1:k){
start <- end +1
end <- start + range -1
Dik <- mdist(X[start:end,])
DMk <- max(Dik)
deltak <- deltak + mean(Dik - DMk)
}
print(deltak)
DW[i] <- deltak/k
i <- i+1
}
DeD <- 2*DW - delta
return(list(DeD=DeD, k=seq[which.min(DeD)]))
}
DeD(X, 2:10)
X <- iris[,1:4]
DeD(X, 2:10)
X <- X[sample.int(nrow(X)),]
DeD(X, 2:10)
X <- X[sample.int(nrow(X)),]
DeD(X, 2:10)
X <- X[sample.int(nrow(X)),]
DeD(X, 2:10)
mu1 <- c(-10,10)
mu2 <- c(10,10)
mu3 <- c(10,-10)
mu4 <- c(-10,-10)
sig1 <- genPositiveDefMat(2)$Sigma
sig2 <- genPositiveDefMat(2)$Sigma
sig3 <- genPositiveDefMat(2)$Sigma
sig4 <- genPositiveDefMat(2)$Sigma
c1 <- mvrnorm(n = 50, mu = mu1, Sigma = 3*diag(2))
c2 <- mvrnorm(n = 50, mu = mu2, Sigma = 3*diag(2))
c3 <- mvrnorm(n = 50, mu = mu3, Sigma = 3*diag(2))
c4 <- mvrnorm(n = 50, mu = mu4, Sigma = 3*diag(2))
X <- rbind(c1,c2,c3,c4)
plot(c1[,1],c1[,2], col="black", xlim = c(-25,25), ylim = c(-25,25))
points(c2[,1],c2[,2], col="blue")
points(c3[,1],c3[,2], col="red")
points(c4[,1], c4[,2], col="green")
DeD(X, 2:10)
X <- X[sample.int(nrow(X)),]
DeD(X, 2:10)
mu1 <- c(-10,10)
mu2 <- c(10,10)
mu3 <- c(10,-10)
mu4 <- c(-10,-10)
sig1 <- genPositiveDefMat(2)$Sigma
sig2 <- genPositiveDefMat(2)$Sigma
sig3 <- genPositiveDefMat(2)$Sigma
sig4 <- genPositiveDefMat(2)$Sigma
c1 <- mvrnorm(n = 150, mu = mu1, Sigma = 3*diag(2))
c2 <- mvrnorm(n = 5, mu = mu2, Sigma = 3*diag(2))
c3 <- mvrnorm(n = 20, mu = mu3, Sigma = 3*diag(2))
c4 <- mvrnorm(n = 75, mu = mu4, Sigma = 3*diag(2))
X <- rbind(c1,c2,c3,c4)
plot(c1[,1],c1[,2], col="black", xlim = c(-25,25), ylim = c(-25,25))
points(c2[,1],c2[,2], col="blue")
points(c3[,1],c3[,2], col="red")
points(c4[,1], c4[,2], col="green")
DeD(X, 2:10)
DeD <- function(X, seq){
n <- nrow(X)
Di <- mdist(X)
DM <- max(Di)
delta <- mean(Di-DM)
DW <- seq
i=1
for (k in seq) {
range <- n/k
start <-0
end <- 0
deltak <- 0
for (j in 1:k){
start <- end +1
end <- start + range -1
print(end)
Dik <- mdist(X[start:end,])
DMk <- max(Dik)
deltak <- deltak + mean(Dik - DMk)
}
print(deltak)
DW[i] <- deltak/k
i <- i+1
}
DeD <- 2*DW - delta
return(list(DeD=DeD, k=seq[which.min(DeD)]))
}
DeD(X, 2:10)
